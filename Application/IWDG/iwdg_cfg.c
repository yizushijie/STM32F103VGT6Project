#include "iwdg_cfg.h"

///////////////////////////////////////////////////////////////////////////////
//////函	   数：
//////功	   能：
//////输入参数:
//////输出参数:
//////说	   明： 在初始化看门狗的时候需要注意关闭全局中断，否则会导致看门狗的设置失败，但是寄存器操作无影响
//////////////////////////////////////////////////////////////////////////////
UINT8_T IWDG_Init(void)
{
	//---关闭中断
	CLI();

	//---使能看门狗
	LL_IWDG_Enable(IWDG);

	//---使能预分频寄存器和重装载寄存器可写（取消寄存器的写保护）
	LL_IWDG_EnableWriteAccess(IWDG);

	//---设置预分频器值
	LL_IWDG_SetPrescaler(IWDG, LL_IWDG_PRESCALER_64);

	//---设置重装载寄存器值
	LL_IWDG_SetReloadCounter(IWDG, 625);

	//---等待准备完成
	while (LL_IWDG_IsReady(IWDG) != 1);

	//---复位看门狗
	LL_IWDG_ReloadCounter(IWDG);

	//---开启中断
	SEI();
	return OK_0;
}

///////////////////////////////////////////////////////////////////////////////
//////函	   数：
//////功	   能：
//////输入参数:
//////输出参数:
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
UINT8_T IWDG_DeInit(void)
{
	return OK_0;
}

///////////////////////////////////////////////////////////////////////////////
//////函	   数：
//////功	   能： 看门狗复位操作
//////输入参数:
//////输出参数:
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
UINT8_T IWDG_Reset(void)
{
	//---复位看门狗
	LL_IWDG_ReloadCounter(IWDG);
	return OK_0;
}